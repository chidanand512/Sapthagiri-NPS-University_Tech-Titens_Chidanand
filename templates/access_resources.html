<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Access Resources</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
        }

        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background: #667eea;
            padding: 30px 0;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        .nav-brand {
            color: white;
            font-size: 24px;
            font-weight: bold;
            padding: 0 20px;
            margin-bottom: 40px;
        }

        .nav-menu {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 5px;
            flex: 1;
        }

        .nav-menu li a {
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            display: block;
            transition: background 0.3s;
        }

        .nav-menu li a:hover,
        .nav-menu li a.active {
            background: rgba(255, 255, 255, 0.2);
        }

        .logout-item {
            margin-top: auto;
        }

        .logout-link {
            background: rgba(255, 255, 255, 0.1);
        }

        .logout-link:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .main-content {
            margin-left: 250px;
            padding: 30px;
        }

        .content-box {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .alert {
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .info-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .info-banner h3 {
            margin-bottom: 10px;
        }

        .info-banner p {
            opacity: 0.9;
            line-height: 1.6;
        }

        .search-section {
            margin-bottom: 20px;
        }

        .search-bar {
            display: flex;
            gap: 10px;
        }

        .search-bar input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
        }

        .search-bar input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-clear {
            padding: 12px 24px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        .btn-clear:hover {
            background: #5a6268;
        }

        .filters-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .filters-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .filters-row:last-child {
            margin-bottom: 0;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            margin-bottom: 6px;
            color: #555;
            font-weight: 500;
            font-size: 14px;
        }

        .filter-group select,
        .filter-group input {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .active-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
        }

        .filter-tag {
            background: #667eea;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-tag .remove {
            cursor: pointer;
            font-weight: bold;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .results-info {
            font-size: 15px;
            color: #666;
            font-weight: 500;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            padding: 20px;
        }

        .page-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .page-btn:hover {
            background: #667eea;
            color: white;
        }

        .page-btn.active {
            background: #667eea;
            color: white;
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-info {
            color: #666;
            font-weight: 500;
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .resource-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
            position: relative;
        }

        .resource-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .resource-card.locked {
            opacity: 0.7;
            background: #f0f0f0;
        }

        .privacy-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-public {
            background: #28a745;
            color: white;
        }

        .badge-private {
            background: #dc3545;
            color: white;
        }

        .resource-card h4 {
            color: #667eea;
            margin-bottom: 12px;
            padding-right: 80px;
            cursor: pointer;
        }

        .resource-card h4:hover {
            text-decoration: underline;
        }

        .resource-card p {
            margin: 6px 0;
            color: #555;
            font-size: 14px;
        }

        .rating-display {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 10px 0;
            padding: 8px;
            background: white;
            border-radius: 6px;
        }

        .stars {
            color: #ffc107;
            font-size: 18px;
            letter-spacing: 2px;
        }

        .rating-text {
            color: #666;
            font-size: 14px;
            font-weight: 500;
        }

        .no-rating {
            color: #999;
            font-size: 13px;
            font-style: italic;
        }

        .resource-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 10px 0;
        }

        .meta-item {
            background: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 13px;
            color: #666;
        }

        .resource-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
        }

        .tag {
            background: #667eea;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 12px;
        }

        .resource-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-download {
            background: #28a745;
            color: white;
        }

        .btn-download:hover {
            background: #218838;
        }

        .btn-locked {
            background: #6c757d;
            color: white;
            cursor: not-allowed;
        }

        .lock-message {
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 13px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #667eea;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }

            .main-content {
                margin-left: 200px;
                padding: 15px;
            }

            .resources-grid {
                grid-template-columns: 1fr;
            }

            .filters {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <div class="sidebar">
        <div class="nav-brand">Student Portal</div>
        <ul class="nav-menu">
            <li><a href="/dashboard">üè† Home</a></li>
            <li><a href="/upload_page">üì§ Upload Resource</a></li>
            <li><a href="/access_resources" class="active">üîê Access Resources</a></li>
            <li><a href="/dashboard#uploaded">üìÅ My Resources</a></li>
            <li><a href="/dashboard#history">üì• Download History</a></li>
            <li><a href="/dashboard#profile">üë§ My Profile</a></li>
            <li class="logout-item"><a href="/logout" class="logout-link">üö™ Logout</a></li>
        </ul>
    </div>

    <div class="main-content">
        <div class="content-box">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            {% for category, message in messages %}
            <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
            {% endif %}
            {% endwith %}

            <h2>üîê Access Resources</h2>

            <div class="info-banner">
                <h3>Access Control & Privacy Settings</h3>
                <p>üîì <strong>Public Resources:</strong> Available to all students from any college</p>
                <p>üîí <strong>Private Resources:</strong> Only accessible to students from the same college ({{
                    user.college }})</p>
                <p>Resources marked as private ensure that your study materials are shared only within your institution.
                </p>
            </div>

            <div class="stats-row">
                <div class="stat-box">
                    <div class="stat-number" id="totalResources">{{ resources|length }}</div>
                    <div class="stat-label">Total Resources</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="publicResources">0</div>
                    <div class="stat-label">Public Resources</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="accessiblePrivate">0</div>
                    <div class="stat-label">Accessible Private</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="lockedResources">0</div>
                    <div class="stat-label">Locked Resources</div>
                </div>
            </div>

            <div class="search-section">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="üîç Search by title, subject, tags, or keywords..."
                        onkeyup="filterResources()">
                    <button onclick="clearAllFilters()" class="btn-clear">Clear All</button>
                </div>
            </div>

            <div class="filters-container">
                <div class="filters-row">
                    <div class="filter-group">
                        <label>Subject/Course</label>
                        <input type="text" id="subjectFilter" placeholder="e.g., Data Structures"
                            onkeyup="filterResources()">
                    </div>
                    <div class="filter-group">
                        <label>Semester</label>
                        <select id="semesterFilter" onchange="filterResources()">
                            <option value="">All Semesters</option>
                            <option value="1st Semester">1st Semester</option>
                            <option value="2nd Semester">2nd Semester</option>
                            <option value="3rd Semester">3rd Semester</option>
                            <option value="4th Semester">4th Semester</option>
                            <option value="5th Semester">5th Semester</option>
                            <option value="6th Semester">6th Semester</option>
                            <option value="7th Semester">7th Semester</option>
                            <option value="8th Semester">8th Semester</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Resource Type</label>
                        <select id="typeFilter" onchange="filterResources()">
                            <option value="">All Types</option>
                            <option value="Notes">Notes</option>
                            <option value="Question Papers">Question Papers</option>
                            <option value="Solutions">Solutions</option>
                            <option value="Project Reports">Project Reports</option>
                            <option value="Study Material">Study Material</option>
                            <option value="Lab Manual">Lab Manual</option>
                            <option value="Presentation">Presentation</option>
                            <option value="Assignment">Assignment</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Branch/Department</label>
                        <input type="text" id="branchFilter" placeholder="e.g., Computer Science"
                            onkeyup="filterResources()">
                    </div>
                </div>

                <div class="filters-row">
                    <div class="filter-group">
                        <label>Year/Batch</label>
                        <input type="text" id="yearFilter" placeholder="e.g., 2024" onkeyup="filterResources()">
                    </div>
                    <div class="filter-group">
                        <label>Privacy Level</label>
                        <select id="privacyFilter" onchange="filterResources()">
                            <option value="">All Resources</option>
                            <option value="Public">Public Only</option>
                            <option value="Private">Private Only</option>
                            <option value="accessible">Accessible Only</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Sort By</label>
                        <select id="sortFilter" onchange="sortResources()">
                            <option value="latest">Latest Uploads</option>
                            <option value="oldest">Oldest First</option>
                            <option value="rating-high">Highest Rated</option>
                            <option value="rating-low">Lowest Rated</option>
                            <option value="most-reviewed">Most Reviewed</option>
                            <option value="title-asc">Title (A-Z)</option>
                            <option value="title-desc">Title (Z-A)</option>
                            <option value="subject-asc">Subject (A-Z)</option>
                            <option value="subject-desc">Subject (Z-A)</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Results Per Page</label>
                        <select id="resultsPerPage" onchange="updatePagination()">
                            <option value="12">12 per page</option>
                            <option value="24">24 per page</option>
                            <option value="48">48 per page</option>
                            <option value="all">Show All</option>
                        </select>
                    </div>
                </div>

                <div class="active-filters" id="activeFilters"></div>
            </div>

            <div class="results-header">
                <div class="results-info">
                    <span id="resultsCount">Showing 0 of 0 resources</span>
                </div>
            </div>

            <div id="resourcesGrid" class="resources-grid">
                {% if resources %}
                {% for resource in resources %}
                <div class="resource-card {% if not resource.accessible %}locked{% endif %}"
                    data-title="{{ resource.title|lower }}" data-subject="{{ resource.subject|lower }}"
                    data-semester="{{ resource.semester }}" data-type="{{ resource.resource_type }}"
                    data-privacy="{{ resource.privacy }}" data-branch="{{ resource.uploader_branch|lower }}"
                    data-year="{{ resource.year_batch }}" data-tags="{{ resource.tags|lower if resource.tags else '' }}"
                    data-date="{{ resource.upload_date }}" data-rating="{{ resource.avg_rating }}"
                    data-accessible="{{ 'true' if resource.accessible else 'false' }}">

                    <span
                        class="privacy-badge {% if resource.privacy == 'Public' %}badge-public{% else %}badge-private{% endif %}">
                        {% if resource.privacy == 'Public' %}üîì Public{% else %}üîí Private{% endif %}
                    </span>

                    <h4 onclick="window.location.href='/resource/{{ resource.id }}'">{{ resource.title }}</h4>

                    <div class="rating-display">
                        {% if resource.review_count > 0 %}
                        <span class="stars">{{ '‚òÖ' * resource.avg_rating|int }}{{ '‚òÜ' * (5 - resource.avg_rating|int)
                            }}</span>
                        <span class="rating-text">{{ resource.avg_rating }} ({{ resource.review_count }} review{{ 's' if
                            resource.review_count != 1 else '' }})</span>
                        {% else %}
                        <span class="no-rating">No reviews yet</span>
                        {% endif %}
                    </div>

                    <div class="resource-meta">
                        <span class="meta-item">üìö {{ resource.subject }}</span>
                        <span class="meta-item">üìñ {{ resource.resource_type }}</span>
                    </div>

                    <p><strong>Semester:</strong> {{ resource.semester }}</p>
                    <p><strong>Branch:</strong> {{ resource.uploader_branch }}</p>
                    <p><strong>Year/Batch:</strong> {{ resource.year_batch }}</p>
                    <p><strong>Uploaded by:</strong> {{ resource.uploader_name }} ({{ resource.uploader_college }})</p>

                    {% if resource.description %}
                    <p><strong>Description:</strong> {{ resource.description[:120] }}{% if resource.description|length >
                        120 %}...{% endif %}</p>
                    {% endif %}

                    {% if resource.tags %}
                    <div class="resource-tags">
                        {% for tag in resource.tags.split(',') %}
                        <span class="tag">{{ tag.strip() }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}

                    <div class="resource-actions">
                        {% if resource.accessible %}
                        <a href="/resource/{{ resource.id }}" class="btn btn-download">üìñ View Details</a>
                        <a href="/download/{{ resource.id }}" class="btn btn-download">üì• Download</a>
                        {% else %}
                        <button class="btn btn-locked" disabled>üîí Locked</button>
                        {% endif %}
                    </div>

                    {% if not resource.accessible %}
                    <div class="lock-message">
                        ‚ö†Ô∏è This resource is private and only available to students from {{ resource.uploader_college }}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
                {% else %}
                <div class="empty-state">
                    <h3>No resources available</h3>
                    <p>Be the first to upload a resource!</p>
                </div>
                {% endif %}
            </div>

            <div class="pagination" id="pagination"></div>
        </div>
    </div>

    <script>
        let allCards = [];
        let currentPage = 1;
        let itemsPerPage = 12;

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function () {
            allCards = Array.from(document.querySelectorAll('.resource-card'));
            calculateStatistics();
            filterResources();
        });

        // Calculate statistics
        function calculateStatistics() {
            let publicCount = 0;
            let accessiblePrivateCount = 0;
            let lockedCount = 0;

            allCards.forEach(card => {
                const privacy = card.dataset.privacy;
                const isLocked = card.classList.contains('locked');

                if (privacy === 'Public') {
                    publicCount++;
                } else if (privacy === 'Private' && !isLocked) {
                    accessiblePrivateCount++;
                } else if (isLocked) {
                    lockedCount++;
                }
            });

            document.getElementById('totalResources').textContent = allCards.length;
            document.getElementById('publicResources').textContent = publicCount;
            document.getElementById('accessiblePrivate').textContent = accessiblePrivateCount;
            document.getElementById('lockedResources').textContent = lockedCount;
        }

        // Main filter function
        function filterResources() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const subjectFilter = document.getElementById('subjectFilter').value.toLowerCase();
            const semesterFilter = document.getElementById('semesterFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const branchFilter = document.getElementById('branchFilter').value.toLowerCase();
            const yearFilter = document.getElementById('yearFilter').value;
            const privacyFilter = document.getElementById('privacyFilter').value;

            let visibleCards = allCards.filter(card => {
                const title = card.dataset.title;
                const subject = card.dataset.subject;
                const tags = card.dataset.tags;
                const semester = card.dataset.semester;
                const type = card.dataset.type;
                const branch = card.dataset.branch;
                const year = card.dataset.year;
                const privacy = card.dataset.privacy;
                const accessible = card.dataset.accessible === 'true';

                // Search filter
                const matchesSearch = !searchTerm ||
                    title.includes(searchTerm) ||
                    subject.includes(searchTerm) ||
                    tags.includes(searchTerm);

                // Subject filter
                const matchesSubject = !subjectFilter || subject.includes(subjectFilter);

                // Semester filter
                const matchesSemester = !semesterFilter || semester === semesterFilter;

                // Type filter
                const matchesType = !typeFilter || type === typeFilter;

                // Branch filter
                const matchesBranch = !branchFilter || branch.includes(branchFilter);

                // Year filter
                const matchesYear = !yearFilter || year.includes(yearFilter);

                // Privacy filter
                let matchesPrivacy = true;
                if (privacyFilter === 'Public') {
                    matchesPrivacy = privacy === 'Public';
                } else if (privacyFilter === 'Private') {
                    matchesPrivacy = privacy === 'Private';
                } else if (privacyFilter === 'accessible') {
                    matchesPrivacy = accessible;
                }

                return matchesSearch && matchesSubject && matchesSemester &&
                    matchesType && matchesBranch && matchesYear && matchesPrivacy;
            });

            // Update active filters display
            updateActiveFilters();

            // Sort the visible cards
            sortResourcesArray(visibleCards);

            // Update results count
            document.getElementById('resultsCount').textContent =
                `Showing ${visibleCards.length} of ${allCards.length} resources`;

            // Reset to page 1 when filters change
            currentPage = 1;

            // Display paginated results
            displayPaginatedResults(visibleCards);
        }

        // Sort resources
        function sortResources() {
            const sortBy = document.getElementById('sortFilter').value;
            // Redirect to access_resources with sort parameter
            window.location.href = '/access_resources?sort=' + sortBy;
        }

        function sortResourcesArray(cards) {
            const sortBy = document.getElementById('sortFilter').value;

            cards.sort((a, b) => {
                switch (sortBy) {
                    case 'latest':
                        return new Date(b.dataset.date) - new Date(a.dataset.date);
                    case 'oldest':
                        return new Date(a.dataset.date) - new Date(b.dataset.date);
                    case 'rating-high':
                        return parseFloat(b.dataset.rating) - parseFloat(a.dataset.rating);
                    case 'rating-low':
                        return parseFloat(a.dataset.rating) - parseFloat(b.dataset.rating);
                    case 'most-reviewed':
                        // Extract review count from rating display
                        const countA = parseInt(a.querySelector('.rating-text')?.textContent.match(/\((\d+)/)?.[1] || 0);
                        const countB = parseInt(b.querySelector('.rating-text')?.textContent.match(/\((\d+)/)?.[1] || 0);
                        return countB - countA;
                    case 'title-asc':
                        return a.dataset.title.localeCompare(b.dataset.title);
                    case 'title-desc':
                        return b.dataset.title.localeCompare(a.dataset.title);
                    case 'subject-asc':
                        return a.dataset.subject.localeCompare(b.dataset.subject);
                    case 'subject-desc':
                        return b.dataset.subject.localeCompare(a.dataset.subject);
                    default:
                        return 0;
                }
            });
        }

        // Display paginated results
        function displayPaginatedResults(visibleCards) {
            const resultsPerPage = document.getElementById('resultsPerPage').value;
            itemsPerPage = resultsPerPage === 'all' ? visibleCards.length : parseInt(resultsPerPage);

            // Hide all cards first
            allCards.forEach(card => card.style.display = 'none');

            // Calculate pagination
            const totalPages = Math.ceil(visibleCards.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;

            // Show only cards for current page
            visibleCards.slice(startIndex, endIndex).forEach(card => {
                card.style.display = 'block';
            });

            // Update pagination controls
            updatePaginationControls(totalPages, visibleCards.length);
        }

        // Update pagination controls
        function updatePaginationControls(totalPages, totalItems) {
            const paginationDiv = document.getElementById('pagination');

            if (totalPages <= 1) {
                paginationDiv.innerHTML = '';
                return;
            }

            let html = '';

            // Previous button
            html += `<button class="page-btn" onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>‚Üê Previous</button>`;

            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                    html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
                } else if (i === currentPage - 3 || i === currentPage + 3) {
                    html += `<span class="page-info">...</span>`;
                }
            }

            // Next button
            html += `<button class="page-btn" onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Next ‚Üí</button>`;

            paginationDiv.innerHTML = html;
        }

        // Go to specific page
        function goToPage(page) {
            currentPage = page;
            filterResources();
        }

        // Update pagination when results per page changes
        function updatePagination() {
            currentPage = 1;
            filterResources();
        }

        // Update active filters display
        function updateActiveFilters() {
            const activeFiltersDiv = document.getElementById('activeFilters');
            const filters = [];

            const searchTerm = document.getElementById('searchInput').value;
            const subjectFilter = document.getElementById('subjectFilter').value;
            const semesterFilter = document.getElementById('semesterFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const branchFilter = document.getElementById('branchFilter').value;
            const yearFilter = document.getElementById('yearFilter').value;
            const privacyFilter = document.getElementById('privacyFilter').value;

            if (searchTerm) filters.push({ label: `Search: ${searchTerm}`, id: 'searchInput' });
            if (subjectFilter) filters.push({ label: `Subject: ${subjectFilter}`, id: 'subjectFilter' });
            if (semesterFilter) filters.push({ label: `Semester: ${semesterFilter}`, id: 'semesterFilter' });
            if (typeFilter) filters.push({ label: `Type: ${typeFilter}`, id: 'typeFilter' });
            if (branchFilter) filters.push({ label: `Branch: ${branchFilter}`, id: 'branchFilter' });
            if (yearFilter) filters.push({ label: `Year: ${yearFilter}`, id: 'yearFilter' });
            if (privacyFilter) filters.push({ label: `Privacy: ${privacyFilter}`, id: 'privacyFilter' });

            if (filters.length === 0) {
                activeFiltersDiv.innerHTML = '';
                return;
            }

            let html = filters.map(filter =>
                `<span class="filter-tag">${filter.label} <span class="remove" onclick="removeFilter('${filter.id}')">√ó</span></span>`
            ).join('');

            activeFiltersDiv.innerHTML = html;
        }

        // Remove individual filter
        function removeFilter(filterId) {
            const element = document.getElementById(filterId);
            if (element.tagName === 'SELECT') {
                element.selectedIndex = 0;
            } else {
                element.value = '';
            }
            filterResources();
        }

        // Clear all filters
        function clearAllFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('subjectFilter').value = '';
            document.getElementById('semesterFilter').selectedIndex = 0;
            document.getElementById('typeFilter').selectedIndex = 0;
            document.getElementById('branchFilter').value = '';
            document.getElementById('yearFilter').value = '';
            document.getElementById('privacyFilter').selectedIndex = 0;
            document.getElementById('sortFilter').selectedIndex = 0;
            currentPage = 1;
            filterResources();
        }
    </script>
</body>

</html>
